# 简易聊天工具 - Demo版本使用说明

## 🎉 Demo版本特性

本Demo版本包含以下功能：

### ✅ 已实现功能
- ✅ UDP广播自动发现局域网用户
- ✅ 一对一聊天消息
- ✅ 群发广播消息
- ✅ 成员列表实时更新
- ✅ 手动刷新成员列表
- ✅ 简洁美观的GUI界面

### ⏳ 未包含功能（可后续添加）
- ⏳ TCP文件传输
- ⏳ 消息历史记录
- ⏳ 用户头像
- ⏳ 消息加密

---

## 🚀 快速开始

### 方法1：直接运行Python脚本

**前提条件**：
- Python 3.8 或更高版本
- 已安装依赖：`pip install -r requirements.txt`

**运行步骤**：
1. 双击 `快速启动.bat`
2. 或在命令行运行：`python run.py`

### 方法2：使用打包的EXE（推荐）

**打包步骤**：
1. 双击 `一键打包.bat`
2. 等待打包完成
3. 在 `dist\` 文件夹找到 `简易聊天工具.exe`

**运行步骤**：
1. 直接双击 `简易聊天工具.exe`
2. 输入用户名
3. 开始聊天！

---

## 💻 使用教程

### 1. 启动程序
- 运行程序后会要求输入用户名
- 输入一个昵称（如：张三）
- 点击确定进入主界面

### 2. 发现其他用户
- 程序启动后自动广播发现其他用户
- 左侧"在线成员"列表会显示发现的用户
- 如果没有发现，点击"🔄 刷新成员列表"按钮

### 3. 发送一对一消息
- 在左侧成员列表中选择一个用户
- 在底部输入框输入消息
- 点击"发送"按钮或按回车键
- 右侧聊天区域会显示：`我 → 对方: 消息内容`

### 4. 发送广播消息
- 在底部输入框输入消息
- 点击"广播"按钮
- 所有在线用户都会收到这条消息
- 显示为：`[广播] 我: 消息内容`

### 5. 退出程序
- 点击窗口关闭按钮
- 确认退出
- 程序会自动通知其他用户你已离线

---

## 🧪 测试方法

### 单机测试（推荐）
1. 打开多个程序实例（运行3-5次）
2. 每个实例输入不同的用户名
3. 观察成员列表是否相互发现
4. 测试发送消息功能

### 局域网测试
1. 在不同电脑上运行程序
2. 确保所有电脑在同一局域网
3. 测试跨设备通信

---

## ⚠️ 常见问题

### Q1: 发现不了其他用户？
**解决方法**：
- 确保所有程序在同一局域网
- 检查防火墙设置，允许UDP 8888端口
- 点击"刷新成员列表"按钮
- Windows防火墙可能会弹出询问，选择"允许访问"

### Q2: 发送消息失败？
**解决方法**：
- 确认对方在线（在成员列表中）
- 确认已选中接收者
- 检查网络连接

### Q3: 程序无法启动？
**解决方法**：
- 检查Python版本：`python --version`
- 安装依赖：`pip install -r requirements.txt`
- 查看错误提示信息

### Q4: 多个实例冲突？
**解决方法**：
- 这是正常的，同一IP的多个实例会被识别为同一用户
- 如需测试，请使用不同电脑或虚拟机

---

## 📝 技术说明

### 网络协议
- **UDP端口 8888**：用于消息传输和成员发现
- **广播地址**：255.255.255.255
- **消息格式**：JSON序列化

### 消息类型
- `DISCOVERY`: 发现请求
- `DISCOVERY_RESPONSE`: 发现响应
- `P2P_MESSAGE`: 一对一消息
- `BROADCAST_MESSAGE`: 广播消息
- `JOIN`: 加入通知
- `LEAVE`: 离开通知
- `REFRESH`: 刷新请求

### 架构说明
- **MessageDispatcher**: 统一消息分发
- **NetworkDiscovery**: 网络发现
- **MessageP2P**: 一对一消息
- **MessageBroadcast**: 广播消息
- **MemberManager**: 成员管理
- **MemberRefresh**: 刷新功能

---

## 🔧 开发说明

### 项目结构
```
computer_network_experiment/
├── src/
│   ├── common/          # 公共模块
│   ├── core/            # 核心功能
│   │   ├── message_dispatcher.py
│   │   ├── network_discovery.py
│   │   ├── message_p2p.py
│   │   ├── message_broadcast.py
│   │   ├── member_manager.py
│   │   └── member_refresh.py
│   └── ui/
│       └── main_window.py
├── run.py               # 启动脚本
├── requirements.txt     # 依赖列表
└── build_exe.py        # 打包脚本
```

### 添加新功能
1. 在相应模块中添加功能
2. 在MainWindow中连接信号
3. 测试功能
4. 重新打包

---

## 📞 技术支持

如有问题，请：
1. 查看本文档的"常见问题"部分
2. 查看控制台输出的错误信息
3. 联系开发团队

---

## 🎓 学习资源

本项目使用的技术：
- Python 3.8+
- PyQt6 (GUI框架)
- Socket编程 (UDP网络通信)
- JSON序列化
- 多线程编程

---

**版本**: Demo v1.0  
**日期**: 2025-12-10  
**开发团队**: 计算机网络实验小组6

---

祝你使用愉快！🎉



