# 成员任务分配表

## 📋 总览

| 成员编号 | 姓名 | 学号 | 负责模块 | 文件路径 | 难度 |
|---------|------|------|---------|---------|------|
| 成员一 | 刘泽楷 | 202300800662 | 自动发现聊天组 | `src/core/network_discovery.py` | ⭐⭐⭐ |
| 成员二 | 马驰原 | 202300800626 | 一对一消息传输 | `src/core/message_p2p.py` | ⭐⭐ |
| 成员三 | 孟俊宇 | 202300800677 | 广播消息 | `src/core/message_broadcast.py` | ⭐⭐ |
| 成员四 | 何准 | 202300800585 | 文件传输 | `src/core/file_transfer.py` | ⭐⭐⭐⭐ |
| 成员五 | 李牧熹 | 202300800609 | 组员管理 | `src/core/member_manager.py` | ⭐⭐⭐ |
| 成员六 | 石明琦 | 202300800596 | 手动刷新组员列表 | `src/core/member_refresh.py` | ⭐⭐ |
| 成员七 | 孙聿轩 | 202300800607 | 界面整合与设计 | `src/ui/main_window.py` | ⭐⭐⭐⭐⭐ |

---

## 👤 成员一：刘泽楷 - 自动发现聊天组

### 📁 负责文件
- `src/core/network_discovery.py`

### 🎯 核心任务
实现通过UDP广播来发现局域网内的聊天组成员

### ✅ 需要实现的函数
1. `start()` - 启动UDP监听服务
2. `stop()` - 停止服务
3. `send_discovery_broadcast()` - 发送发现广播
4. `_listen_loop()` - 监听循环
5. `_handle_discovery_request()` - 处理发现请求
6. `_handle_discovery_response()` - 处理发现响应

### 💡 实现提示
- 创建UDP socket并设置`SO_BROADCAST`选项
- 使用线程持续监听UDP消息
- 发现请求包含关键字 `DISCOVERY_KEYWORD`
- 发现新成员时触发 `member_discovered` 信号

### 📚 参考资料
- Python socket编程：UDP广播
- 开发指南.md - 成员一部分

---

## 👤 成员二：马驰原 - 一对一消息传输

### 📁 负责文件
- `src/core/message_p2p.py`

### 🎯 核心任务
实现点对点消息的发送和接收

### ✅ 需要实现的函数
1. `send_p2p_message(receiver, content)` - 发送消息
2. `handle_received_message(data, addr)` - 处理接收的消息

### 💡 实现提示
- 使用共享的UDP socket发送消息
- 消息类型为 `MessageType.P2P_MESSAGE`
- 使用 `serialize_message()` 序列化消息
- 接收到消息后触发 `message_received` 信号

### 📚 参考资料
- common/message_types.py - ChatMessage类
- common/utils.py - 序列化函数

---

## 👤 成员三：孟俊宇 - 广播消息

### 📁 负责文件
- `src/core/message_broadcast.py`

### 🎯 核心任务
实现向所有在线成员广播消息

### ✅ 需要实现的函数
1. `send_broadcast_message(content)` - 发送广播消息
2. `handle_broadcast_message(data, addr)` - 处理接收的广播消息

### 💡 实现提示
- 遍历 `member_list` 向每个成员发送
- 消息类型为 `MessageType.BROADCAST_MESSAGE`
- 不需要指定receiver
- 接收到广播后触发 `broadcast_received` 信号

### 📚 参考资料
- 参考 message_p2p.py 的实现
- 区别在于需要向多个成员发送

---

## 👤 成员四：何准 - 文件传输

### 📁 负责文件
- `src/core/file_transfer.py`

### 🎯 核心任务
实现基于TCP协议的可靠文件传输

### ✅ 需要实现的函数
1. `start()` - 启动TCP监听服务
2. `stop()` - 停止服务
3. `_send_file_thread(file_path, receiver)` - 发送文件线程
4. `_listen_loop()` - 监听TCP连接
5. `_handle_client(client_socket, addr)` - 处理客户端连接
6. `accept_file()` / `reject_file()` - 接受/拒绝文件

### 💡 实现提示
- 创建TCP socket并监听 `DEFAULT_TCP_PORT`
- 发送文件：
  1. 连接到接收方TCP端口
  2. 发送文件信息（文件名、大小）
  3. 等待确认
  4. 分块发送文件内容
- 接收文件：
  1. 接受连接
  2. 接收文件信息
  3. 询问用户是否接受
  4. 接收并保存文件
- 使用 `FILE_CHUNK_SIZE` 分块传输
- 触发 `transfer_progress` 更新进度

### 📚 参考资料
- Python TCP socket编程
- 文件分块读写
- 开发指南.md - 成员四部分

⚠️ **注意**：这是难度最高的模块之一，建议先完成基础功能再优化

---

## 👤 成员五：李牧熹 - 组员管理

### 📁 负责文件
- `src/core/member_manager.py`

### 🎯 核心任务
管理聊天组成员列表，处理成员的加入和离开

### ✅ 需要实现的函数
1. `add_member(member)` - 添加成员
2. `remove_member(member)` - 移除成员
3. `get_member_by_ip(ip, port)` - 查找成员
4. `broadcast_join()` - 广播加入消息
5. `broadcast_leave()` - 广播离开消息
6. `handle_join_message()` - 处理加入消息
7. `handle_leave_message()` - 处理离开消息

### 💡 实现提示
- 使用 `List[Member]` 维护成员列表
- 添加成员前检查是否已存在
- 添加/移除时触发相应信号
- 加入/离开时广播通知其他成员
- 使用 `MessageType.JOIN` 和 `MessageType.LEAVE`

### 📚 参考资料
- common/message_types.py - Member类
- Python list操作

---

## 👤 成员六：石明琦 - 手动刷新组员列表

### 📁 负责文件
- `src/core/member_refresh.py`

### 🎯 核心任务
实现手动刷新功能，重新发现在线成员

### ✅ 需要实现的函数
1. `refresh_members()` - 发起刷新
2. `handle_refresh_request(sender_addr)` - 处理刷新请求
3. `handle_refresh_response(message)` - 处理刷新响应

### 💡 实现提示
- 类似于网络发现模块
- 使用 `MessageType.REFRESH`
- 防止重复刷新（使用 `is_refreshing` 标志）
- 触发 `refresh_started` 和 `refresh_completed` 信号
- 可以设置超时时间

### 📚 参考资料
- 参考 network_discovery.py 的实现
- 本质上是按需触发的发现功能

---

## 👤 成员七：孙聿轩 - 界面整合与设计

### 📁 负责文件
- `src/ui/main_window.py`

### 🎯 核心任务
整合所有功能模块，设计并实现用户界面

### ✅ 需要实现的函数
1. `init_modules()` - 初始化所有核心模块
2. `connect_signals()` - 连接信号和槽
3. `on_refresh_members()` - 刷新按钮处理
4. `on_send_message()` - 发送消息按钮处理
5. `on_broadcast_message()` - 广播按钮处理
6. `on_send_file()` - 发送文件按钮处理
7. 所有槽函数 (`on_member_discovered`, `on_message_received` 等)

### 💡 实现提示
- 初始化时创建本地Member对象
- 创建所有核心模块实例
- 连接各模块的信号到UI槽函数
- 实现各个按钮的事件处理
- 更新UI显示（成员列表、聊天记录）
- 处理窗口关闭事件，清理资源

### 📚 参考资料
- PyQt6文档
- 信号槽机制
- 已实现的UI框架代码

⚠️ **注意**：这是工作量最大的模块，需要等其他模块基本完成后进行整合

---

## 🔄 开发流程建议

### 阶段一：基础功能（第1-2周）
1. **成员一** 先完成网络发现
2. **成员五** 完成组员管理（依赖成员一）
3. **成员二、三、六** 可以并行开发

### 阶段二：高级功能（第3周）
4. **成员四** 完成文件传输

### 阶段三：整合测试（第4周）
5. **成员七** 整合所有模块
6. 全体成员联调测试

---

## 📝 每日任务报告模板

在小组群中每日汇报进度：

```
【姓名】成员X - XXX
【日期】2025-12-XX
【今日完成】
- 完成了XXX函数的实现
- 测试了XXX功能
【遇到的问题】
- XXX问题（已解决/未解决）
【明日计划】
- 实现XXX功能
- 测试XXX模块
```

---

## 🤝 协作建议

1. **及时沟通**：遇到问题及时在群里讨论
2. **代码提交**：完成一个功能就提交一次
3. **接口对接**：涉及模块间调用的，先确认接口
4. **测试先行**：自己的模块先测试通过再整合
5. **文档更新**：有修改及时更新相关文档

---

## 📞 联系方式

小组长：XXX（负责协调进度）
技术负责：XXX（解决技术难题）

---

## ✨ 祝大家开发顺利！

